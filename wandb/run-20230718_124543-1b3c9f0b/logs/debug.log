2023-07-18 12:45:43,744 INFO    MainThread:216035 [wandb_setup.py:_flush():76] Current SDK version is 0.15.5
2023-07-18 12:45:43,744 INFO    MainThread:216035 [wandb_setup.py:_flush():76] Configure stats pid to 216035
2023-07-18 12:45:43,744 INFO    MainThread:216035 [wandb_setup.py:_flush():76] Loading settings from /home/alex.li/.config/wandb/settings
2023-07-18 12:45:43,744 INFO    MainThread:216035 [wandb_setup.py:_flush():76] Loading settings from /home/alex.li/git/scripts/wandb/settings
2023-07-18 12:45:43,744 INFO    MainThread:216035 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'api_key': '***REDACTED***'}
2023-07-18 12:45:43,744 INFO    MainThread:216035 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-07-18 12:45:43,744 WARNING MainThread:216035 [wandb_setup.py:_flush():76] Could not save program above cwd: /home/alex.li/git/JupiterCVML/europa/base/src/europa/dl/scripts/trainer.py
2023-07-18 12:45:43,744 INFO    MainThread:216035 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': None, 'program': '/home/alex.li/git/JupiterCVML/europa/base/src/europa/dl/scripts/trainer.py'}
2023-07-18 12:45:43,744 INFO    MainThread:216035 [wandb_init.py:_log_setup():507] Logging user logs to /home/alex.li/git/scripts/wandb/run-20230718_124543-1b3c9f0b/logs/debug.log
2023-07-18 12:45:43,744 INFO    MainThread:216035 [wandb_init.py:_log_setup():508] Logging internal logs to /home/alex.li/git/scripts/wandb/run-20230718_124543-1b3c9f0b/logs/debug-internal.log
2023-07-18 12:45:43,744 INFO    MainThread:216035 [wandb_init.py:init():547] calling init triggers
2023-07-18 12:45:43,745 INFO    MainThread:216035 [wandb_init.py:init():554] wandb.init called with sweep_config: {}
config: {'dataset': 'jupiter-farmfield-v1.9', 'losses': {'msl': 1.0, 'tv': 1.0, 'prodl': 0.02}, 'optimizer': 'adamw', 'model': 'brtresnetpyramid', 'model_params': {'num_block_layers': 2, 'widening_factor': 2, 'upsample_mode': 'nearest', 'bias': True}, 'dust_output_params': {'dust_head_output': True, 'dust_class_ratio': False, 'dust_class_confidence_map': False, 'zero_dust_ratio': False, 'dust_head_output_multiplier': 100, 'dust_head_output_threshold': 10, 'threshold_on_dust_channel': 0.35}, 'no_intermediate_embeddings': False, 'data_dir': '/data/jupiter/datasets/Jupiter_train_v5_11/', 'csv_path': '/data/jupiter/li.yu/data/Jupiter_train_v5_11/epoch0_5_30_focal05_master_annotations.csv', 'csv_path_validation': None, 'output_dir': '/data/jupiter/alex.li/test/results', 'save_pred_every': 2500, 'snapshot_dir': 'test/1b3c9f0b', 'batch_size': 32, 'fp16': False, 'ignore_label': 255, 'input_size': [512, 1024], 'input_mode': 'RGBD', 'input_dims': 4, 'is_training': False, 'learning_rate': 0.001, 'fine_tune_lr': 0, 'momentum': 0.9, 'start_iters': 0, 'num_steps': 100000, 'power': 0.9, 'restore_from': '', 'resume_from_snapshot': False, 'save_num_images': 2, 'val_set_ratio': 0.2, 'val_set_metrics': True, 'early_stop_patience': 7, 'weight_decay': 0.001, 'night_model': {'use': True, 'dark_pix_threshold': 10}, 'gpu': 'all', 'num_workers': 64, 'seed': 304, 'store_output': 'False', 'epochs': 50, 'eval': False, 'fix_lr': False, 'log_file': '', 'epsilon': 1e-06, 'color_jitter': {'brightness': 0.1, 'contrast': 0, 'saturation': 0.2, 'hue': 0.3}, 'trivial_augment': {'use': True, 'fill': 0}, 'lr_scheduler_name': 'cosinelr', 'lr_scheduler_parameters': {'steplr_step_size': 7, 'steplr_gamma': 0.1, 'cosinelr_T_max': 30, 'cosinelr_eta_min': 1e-06}, 'focalloss_parameters': {'alpha': [1.0, 1.0, 1.0, 1.0], 'gamma': 2.0}, 'tversky_parameters': {'fp_weight': [1.0, 1.0, 1.0, 1.0], 'fn_weight': [1.0, 1.0, 1.0, 1.0], 'class_weight': [1.0, 1.0, 1.0, 1.0], 'gamma': 1.0}, 'huberloss_beta': 1.0, 'equalizationloss_parameters': {'T': [0.0, 1.0, 0.0, 0.0]}, 'productivity_loss_params': {'depth_thresh': 0.35, 'prob_thresh': 0.01}, 'multiscaleloss_weight': 0.1, 'multiscalemixedloss_parameters': {'scale_weight': 0.1, 'dust_weight': 0.5, 'dust_scale_weight': 0.05}, 'run_id': '1b3c9f0b', 'focalloss_expdecay': {'use': False, 'exp_min': 1, 'exp_max': 10}, 'adj_img_gamma': {'use': False, 'gamma_low': 0.3, 'gamma_high': 0.9, 'gain_low': 0.5, 'gain_high': 1.2}, 'adj_color_temp': {'use': False, 'temp_low': 2001, 'temp_high': 15000}, 'save_states_visualizations': True, 'exp_name': 'test', 'states_to_save': ['true_positive', 'true_negative', 'false_positive', 'false_negative', 'large_object_true_positive', 'large_object_false_negative', 'human_true_positive', 'human_true_negative', 'human_false_positive', 'human_false_negative', 'vehicle_true_positive', 'vehicle_true_negative', 'vehicle_false_positive', 'vehicle_false_negative'], 'gt_stop_classes_to_consider': ['Humans'], 'checkpoint_metric': 'val/loss', 's3_checkpoint_path': '', 'human_augmentation': {'use': False}, 'normalization_params': {'policy': 'tonemap', 'alpha': 0.25, 'beta': 0.9, 'gamma': 0.9, 'eps': 1e-06}, 'label_map_file': '/home/alex.li/git/JupiterCVML/europa/base/src/europa/dl/config/label_maps/four_class_train.csv', 'run_pre_val': False, 'save_data_sample': False, 'val_csv': '/home/alex.li/git/JupiterCVML/europa/base/src/europa/dl/config/val_ids/Jupiter_val_ids_v4_63_geohash.csv', 'weighted_sampling': {'birds': 1.0, 'humans': 1.0, 'reverse_humans': 3.0}, 'hard_sampling': {'use': False, 'warmup_epochs': 2, 'min_pix_count': 200, 'gamma': 1.0, 'multiplier': 4.0, 'safety_max_weight': 20.0, 'productivity': True, 'depth_threshold': 0.25, 'max_area_denominator': 2000, 'productivity_max_weight': 20.0}, 'skip_mismatched_layers': False, 'half_res_output': False, 'use_albumentation_transform': False, 'threshold_min_pixels': 400, 'use_depth_threshold': False, 'side_left_tire_mask': '/home/alex.li/git/JupiterCVML/europa/base/src/europa/dl/config/tire_masks/side_left_mask.png', 'side_right_tire_mask': '/home/alex.li/git/JupiterCVML/europa/base/src/europa/dl/config/tire_masks/side_right_mask.png', 'dust_mask': 'NO MASK INVALID PATH', 'flip_lo_pixels': False, 'confidence_threshold': 0.8, 'run_productivity_metrics': True, 'test_time_augmentation': False, 'merge_stop_class_confidence_threshold': -1, 'depth_thresholds': {'front': 0.12, 'side': 0.14, 'rear': 0.25}, 'vat': False, 'dust_class_metrics': True, 'tqdm': False, 'notes': None, 'pred_tag': '', 'num_classes': 4}
2023-07-18 12:45:43,745 INFO    MainThread:216035 [wandb_init.py:init():596] starting backend
2023-07-18 12:45:43,745 INFO    MainThread:216035 [wandb_init.py:init():600] setting up manager
2023-07-18 12:45:43,748 INFO    MainThread:216035 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-07-18 12:45:43,752 INFO    MainThread:216035 [wandb_init.py:init():606] backend started and connected
2023-07-18 12:45:43,762 INFO    MainThread:216035 [wandb_init.py:init():705] updated telemetry
2023-07-18 12:45:43,776 INFO    MainThread:216035 [wandb_init.py:init():738] communicating run to backend with 60.0 second timeout
2023-07-18 12:45:44,603 INFO    MainThread:216035 [wandb_run.py:_on_init():2173] communicating current version
2023-07-18 12:45:44,680 INFO    MainThread:216035 [wandb_run.py:_on_init():2182] got version response 
2023-07-18 12:45:44,680 INFO    MainThread:216035 [wandb_init.py:init():789] starting run threads in backend
2023-07-18 12:45:48,097 INFO    MainThread:216035 [wandb_run.py:_console_start():2152] atexit reg
2023-07-18 12:45:48,098 INFO    MainThread:216035 [wandb_run.py:_redirect():2007] redirect: SettingsConsole.WRAP_RAW
2023-07-18 12:45:48,099 INFO    MainThread:216035 [wandb_run.py:_redirect():2072] Wrapping output streams.
2023-07-18 12:45:48,099 INFO    MainThread:216035 [wandb_run.py:_redirect():2097] Redirects installed.
2023-07-18 12:45:48,100 INFO    MainThread:216035 [wandb_init.py:init():830] run started, returning control to user process
2023-07-18 12:45:48,102 INFO    MainThread:216035 [wandb_watch.py:watch():51] Watching
